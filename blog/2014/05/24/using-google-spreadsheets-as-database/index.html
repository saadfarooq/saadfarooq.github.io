<!DOCTYPE html><html><!DOCTYPE html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>Using Google Spreadsheets as a Database with OAUTH</title><meta name=viewport content="width=device-width"><link rel=stylesheet href="http://fonts.googleapis.com/css?family=Open+Sans:300,400italic,400,600,700|Abril+Fatface"><!-- <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css" rel="stylesheet"> --><link href=//netdna.bootstrapcdn.com/bootswatch/3.0.3/yeti/bootstrap.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css rel=stylesheet><script src=http://code.jquery.com/jquery-2.0.3.min.js></script><script src=//netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js></script><link rel=stylesheet href=/css/f79b.main.css></head><body><div class=row><header class="masthead col-md-4"><div class="inner text-center"><a href="/"><img src="http://www.gravatar.com/avatar/da46d3d12af35a4f70339ac6aba7f9c8?s=150" class="center-block img-circle img-responsive"></a><h1>Saad Farooq</h1><p class=lead>I have issues... need pull requests</p><div id=contact-list class=text-center><ul class="list-unstyled list-inline"><li><a class="btn btn-circle btn-sm" href=https://github.com/sfarooq><i class="fa fa-github-alt fa-lg fa-2x fa-inverse"></i></a></li><li><a class="btn btn-circle btn-sm" href=https://twitter.com/unimpeccable><i class="fa fa-twitter fa-lg fa-2x"></i></a></li><li><a class="btn btn-circle btn-sm" href=mailto:sa@dfarooq.com><i class="fa fa-envelope fa-lg fa-2x"></i></a></li></ul><ul id=contact-list-secondary class="list-unstyled list-inline"></ul></div><div class=colophon><!--             <ul class="colophon-links">
                <li>
                    <a href="httdanps://github.com/mdo/hyde/archive/v.zip">Download</a>
                </li>
                <li>
                    <a href="https://github.com/mdo/hyde">GitHub project</a>
                </li>
            </ul> --><p>&copy; 2014. Saad Farooq All rights reserved.</p></div></div></header><div class="content col-md-8 col-md-offset-4"><h2>Using Google Spreadsheets as a Database with OAUTH</h2><p class=meta>24 May 2014</p><div class=post><p>Say you are working on a simple data acquisition project. You gather some data using a mobile device and you want to be able to manage the collected data quickly and easily. You end up implementing a web hosted SQL database that you send you data to. Then later, you go through all the hassles of exporting and importing that data into a format that you are more comfortable working with and sharing with others. Probably a spreadsheet.</p><p>One fine day, you realize, wouldn&#39;t it be nice if I could just send that data directly to a spreadsheet instead of going through those additional steps. You think of Google Spreadsheets and you are pretty confident that you enough about HTTP to be able to get the data through. It seems a great solution so you start looking at communicating with Google Spreadsheets from your app.</p><p>But then, you run into all the authentication problems and the complexity associated with the GDATA (Google Data) API&#39;s and you think about pulling your (remaining) hair out.</p><p>Wouldn&#39;t it be great if there was a quick and easy way to just send your data to be added to a Google Spreadsheet without having to worry about all this authentication stuff. Well, lucky you. Cause today we&#39;re going to walk through how to do that.</p><p>STEP 1: Set up your recipient spreadsheet</p><p>Go to Google Docs (or Drive now) and create a new Spreadsheet and give it a name.</p><p>Then give the columns you need to use appropriate headers. I&#39;m going to assume I&#39;m cataloging data on flowers so I&#39;ll give it three columns; Name, Family, Color.</p><p>Go to Tools -&gt; Create a Form.</p><p><img src=/img/2d91.post_spreadsheet_form.png alt="create form" title="Create a form"></p><p>Un-check the &quot;Require sign-in to view this form.&quot; checkbox (this allows you to post to the form without authenticating).</p><p><img src=/img/b4a9.post_spreadsheet_authenticate.png alt="remove authentication" title="Remove authentication option"></p><p>Save and close the form windows. You should notice a &quot;Timestamp&quot; column. Now go to Form -&gt; Go to Live Form. You should see something like this.</p><p><img src=/img/e824.post_spreadsheet_live_form.png alt="live form" title="Check the live form"></p><p>You can enter data into this form and it will populate the spreadsheet. We&#39;re going to have a look under the hood now to see how this is done and how we can do it using other methods.</p><p>Step 2: Get the HTTP POST parameters</p><p>Right click on the page and choose &#39;View page source&#39;. You&#39;ll notice that the webpage uses an HTML form to submit the data. The form action is something like this.</p><div class=highlight><pre><code class="text language-text" data-lang=text>&lt;form action=&quot;https://docs.google.com/a/spreadsheet/formResponse?formkey=dHYwFVNKTsd2VzAteEpieTB3NjgTenc6MQ&amp;amp;ifq&quot; method=&quot;POST&quot; id=&quot;ss-form&quot;&gt;
</code></pre></div><p>The &#39;action&#39; attribute defines the Google Spreadsheet form URL where the data will be posted to by the form. Input elements in the HTML defines the form inputs. The first input box for &#39;Name&#39; is given as:</p><div class=highlight><pre><code class="text language-text" data-lang=text>&lt;input type=&quot;text&quot; name=&quot;entry.0.single&quot; value=&quot;&quot; class=&quot;ss-q-short&quot; id=&quot;entry_0&quot;&gt;
</code></pre></div><p>The next box defines the &#39;Family&#39; parameter.</p><div class=highlight><pre><code class="text language-text" data-lang=text>&lt;input type=&quot;text&quot; name=&quot;entry.1.single&quot; value=&quot;&quot; class=&quot;ss-q-short&quot; id=&quot;entry_1&quot;&gt;
</code></pre></div><p>Finally, the &#39;Color&#39; input box corresponds to.</p><div class=highlight><pre><code class="text language-text" data-lang=text>&lt;input type=&quot;text&quot; name=&quot;entry.2.single&quot; value=&quot;&quot; class=&quot;ss-q-short&quot; id=&quot;entry_2&quot;&gt;
</code></pre></div><p>There are also two other inputs that you&#39;ll need</p><div class=highlight><pre><code class="text language-text" data-lang=text>&lt;input type=&quot;hidden&quot; name=&quot;pageNumber&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;backupCache&quot; value=&quot;&quot;&gt;
</code></pre></div><p>and form submit input</p><div class=highlight><pre><code class="text language-text" data-lang=text>&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot;&gt;
</code></pre></div><p>Based on the above, something like the following sent to the form action URL should result in a row addition to the spreadsheet.</p><div class=highlight><pre><code class="text language-text" data-lang=text>entry.0.single=Sunflower&amp;entry.1.single=Asteraceae&amp;entry.2.single=Yellow&amp;pageNumber=0&amp;backupCache=&quot;&quot;
</code></pre></div><p>Notice that we also send the hidden inputs but that they take the same values as described in the form. The content type for the POST call is the standard form input &#39;application/x-www-form-urlencoded&#39;.</p><p>Once you&#39;ve performed the POST, you should get something like this.</p><p><img src=/img/4284.post_spreadsheet_final.png alt="resulting spreadsheet" title="Spreadsheet with entry"></p><p>Step 3: Using a client to POST</p><p>Whatever platform you use there should be a number of examples out there on how to perform POST calls. All you&#39;ll ready need to do is replace the values for your form.</p><p>Happy Coding !!!</p></div><hr><div id=disqus_thread></div><script type=text/javascript>var disqus_developer = 1; 
  
  var disqus_shortname = 'saadfarooq'; // required: replace example with your forum shortname
  
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=http://disqus.com class=dsq-brlink>blog comments powered by <span class=logo-disqus>Disqus</span></a></div></div><!-- footer.html --><footer><hr><!-- <p>
 	&copy; 2014 Saad Farooq.
 </p>
 <p>Made with Jekyll</p> --></footer><script src=/js/d41d.scripts.js></script><!-- footer.html end --></body></html></html>